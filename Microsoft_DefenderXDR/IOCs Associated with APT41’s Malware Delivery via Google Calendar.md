**IOCs Associated with APT41’s Malware Delivery via Google Calendar**

APT41, a threat actor linked to China, employed a sophisticated malware delivery and execution technique in a recent campaign. To summarise, the steps are:

▶️ Initial Access via Spear Phishing: They sent targeted emails containing links to a ZIP archive hosted on a compromised government website.

▶️ Google Cloud Malicious Archive Contents: The ZIP file included an LNK file disguised as a PDF and a directory with .jpg images.

▶️ Execution and Deception: When the LNK file was executed, it deleted itself and displayed a decoy PDF to distract the user.

▶️  Malware Deployment: Simultaneously, the malware payload, named "TOUGHPROGRESS," was deployed.

▶️ Command and Control via Google Calendar: The malware utilized Google Calendar for command and control communications, blending malicious traffic with legitimate services to evade detection.

This approach highlights APT41's innovative tactics in leveraging trusted platforms for malicious activities


```
let SHA256Hashes = dynamic(['469b534bec827be03c0823e72e7b4da0b84f53199040705da203986ef154406a', '3b88b3efbdc86383ee9738c92026b8931ce1c13cd75cd1cda2fa302791c2c4fb', '50124174a4ac0d65bf8b6fd66f538829d1589edc73aa7cf36502e57aa5513360', '151257e9dfda476cdafd9983266ad3255104d72a66f9265caa8417a5fe1df5d7']);
let Domains = dynamic(['roame.travel','word.msapp.workers.dev', 'cloud.msapp.workers.dev', 'term-restore-satisfied-hence.trycloudflare.com', 'ways-sms-pmc-shareholders.trycloudflare.com', 'resource.infinityfreeapp.com', 'pubs.infinityfreeapp.com']);
let URLs = dynamic(['https://lihi.cc/6dekU', 'https://lihi.cc/v3OyQ', 'https://lihi.cc/5nlgd', 'https://lihi.cc/edcOv', 'https://lihi.cc/4z5sh', 'https://tinyurl.com/mr42t4yv', 'https://tinyurl.com/hycev3y7', 'https://tinyurl.com/mpa2c5wj', 'https://tinyurl.com/3wnz46pv', 'https://my5353.com/ppOH5', 'https://my5353.com/nWyTf', 'https://my5353.com/fPUcX', 'https://my5353.com/ZwEkm', 'https://my5353.com/vEWiT', 'https://reurl.cc/WNr2Xy']);
EmailEvents
| where DeliveryLocation has "Inbox"
| join kind=inner (UrlClickEvents) on $left.NetworkMessageId ==  $right.NetworkMessageId
| join kind=inner (EmailAttachmentInfo) on $left.NetworkMessageId ==  $right.NetworkMessageId
| where SenderFromDomain has_any (Domains) or SenderMailFromDomain has_any (Domains) or  Url  has_any (URLs) or SHA256 has_any (SHA256Hashes)
```
